12/17/2022 20:39:44 - INFO - __main__ - Namespace(model_name='openai/clip-vit-base-patch32', task_name='mscoco', ckpt_dir='ckpt', output_dir='outputs/openai/clip-vit-base-patch32/mscoco/0.65/seed_14', gpu=1, constraint=0.65, num_samples=2048, seed=14)
12/17/2022 20:39:44 - INFO - __main__ - Seed number: 14
  0%|          | 0/64 [00:00<?, ?it/s]  2%|â–         | 1/64 [00:16<17:01, 16.21s/it]  3%|â–Ž         | 2/64 [00:30<15:34, 15.07s/it]  5%|â–         | 3/64 [00:44<15:01, 14.78s/it]  6%|â–‹         | 4/64 [00:59<14:44, 14.74s/it]  8%|â–Š         | 5/64 [01:14<14:24, 14.65s/it]  9%|â–‰         | 6/64 [01:28<14:12, 14.70s/it] 11%|â–ˆ         | 7/64 [01:45<14:26, 15.20s/it] 12%|â–ˆâ–Ž        | 8/64 [02:01<14:28, 15.51s/it] 14%|â–ˆâ–        | 9/64 [02:16<14:14, 15.53s/it] 16%|â–ˆâ–Œ        | 10/64 [02:32<13:58, 15.52s/it] 17%|â–ˆâ–‹        | 11/64 [02:48<13:45, 15.57s/it] 19%|â–ˆâ–‰        | 12/64 [03:03<13:20, 15.38s/it] 20%|â–ˆâ–ˆ        | 13/64 [03:18<13:00, 15.30s/it] 22%|â–ˆâ–ˆâ–       | 14/64 [03:33<12:39, 15.20s/it] 23%|â–ˆâ–ˆâ–Ž       | 15/64 [03:47<12:19, 15.09s/it] 25%|â–ˆâ–ˆâ–Œ       | 16/64 [04:03<12:10, 15.21s/it] 27%|â–ˆâ–ˆâ–‹       | 17/64 [04:18<11:56, 15.25s/it] 28%|â–ˆâ–ˆâ–Š       | 18/64 [04:33<11:40, 15.24s/it] 30%|â–ˆâ–ˆâ–‰       | 19/64 [04:49<11:26, 15.25s/it] 31%|â–ˆâ–ˆâ–ˆâ–      | 20/64 [05:04<11:12, 15.28s/it] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 21/64 [05:19<10:57, 15.28s/it] 34%|â–ˆâ–ˆâ–ˆâ–      | 22/64 [05:36<10:54, 15.57s/it] 36%|â–ˆâ–ˆâ–ˆâ–Œ      | 23/64 [05:53<10:54, 15.97s/it] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 24/64 [06:09<10:42, 16.06s/it] 39%|â–ˆâ–ˆâ–ˆâ–‰      | 25/64 [06:24<10:14, 15.76s/it] 41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 26/64 [06:39<09:49, 15.52s/it] 42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 27/64 [06:54<09:33, 15.50s/it] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 28/64 [07:09<09:12, 15.34s/it] 45%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 29/64 [07:24<08:53, 15.23s/it] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 30/64 [07:39<08:34, 15.13s/it] 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 31/64 [07:53<08:10, 14.86s/it] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 32/64 [08:08<07:51, 14.75s/it] 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 33/64 [08:22<07:29, 14.50s/it] 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 34/64 [08:37<07:18, 14.62s/it] 55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 35/64 [08:51<07:03, 14.60s/it] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 36/64 [09:06<06:48, 14.58s/it] 58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 37/64 [09:20<06:35, 14.63s/it] 59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 38/64 [09:36<06:23, 14.76s/it] 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 39/64 [09:50<06:09, 14.80s/it] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 40/64 [10:05<05:56, 14.87s/it] 64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 41/64 [10:20<05:39, 14.75s/it] 66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 42/64 [10:35<05:27, 14.89s/it] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 43/64 [10:50<05:14, 14.98s/it] 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 44/64 [11:05<04:55, 14.80s/it] 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 45/64 [11:20<04:42, 14.87s/it] 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 46/64 [11:35<04:29, 14.98s/it] 73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 47/64 [11:50<04:14, 14.97s/it] 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 48/64 [12:05<03:58, 14.88s/it] 77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 49/64 [12:20<03:44, 14.99s/it] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 50/64 [12:35<03:31, 15.08s/it] 80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 51/64 [12:50<03:15, 15.00s/it] 81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 52/64 [13:05<02:59, 14.95s/it] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 53/64 [13:20<02:46, 15.10s/it] 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 54/64 [13:36<02:31, 15.15s/it] 86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 55/64 [13:50<02:15, 15.09s/it] 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 56/64 [14:05<01:59, 14.92s/it] 89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 57/64 [14:20<01:44, 14.89s/it] 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 58/64 [14:35<01:29, 14.87s/it] 92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 59/64 [14:49<01:13, 14.60s/it] 94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 60/64 [15:03<00:58, 14.51s/it] 95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 61/64 [15:18<00:43, 14.64s/it] 97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 62/64 [15:33<00:29, 14.69s/it] 98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 63/64 [15:46<00:14, 14.38s/it]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 64/64 [16:01<00:00, 14.51s/it]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 64/64 [16:01<00:00, 15.03s/it]
12/17/2022 20:56:18 - INFO - __main__ - Pruned Model MAC: 65.00 %
Nonzero headmask and neuron mask percentage:  tensor(0.5694, device='cuda:0') tensor(0.6916, device='cuda:0')
  0%|          | 0/12 [00:00<?, ?it/s]  8%|â–Š         | 1/12 [06:04<1:06:49, 364.48s/it] 17%|â–ˆâ–‹        | 2/12 [07:49<35:21, 212.13s/it]   25%|â–ˆâ–ˆâ–Œ       | 3/12 [10:57<30:07, 200.83s/it] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 4/12 [14:22<26:58, 202.34s/it] 42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 5/12 [17:27<22:52, 196.09s/it] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 6/12 [20:32<19:14, 192.45s/it] 58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 7/12 [23:26<15:32, 186.51s/it] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 8/12 [26:23<12:14, 183.55s/it] 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 9/12 [27:49<07:39, 153.00s/it] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 10/12 [28:32<03:57, 118.94s/it] 92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 11/12 [28:53<01:28, 88.93s/it] 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 12/12 [29:14<00:00, 68.32s/it]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 12/12 [29:14<00:00, 146.21s/it]
12/17/2022 21:25:39 - INFO - __main__ - mscoco Pruning time (s): 2722.0893766880035
abnormal scale factor neuron: tensor(-3.9720, dtype=torch.float64) tensor(25.6469, dtype=torch.float64)
abnormal scale factor neuron: tensor(-8.6882, dtype=torch.float64) tensor(25.7067, dtype=torch.float64)
  0%|          | 0/4 [00:00<?, ?it/s] 25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:19<00:59, 19.80s/it] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:38<00:38, 19.44s/it] 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:58<00:19, 19.30s/it] 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [01:00<00:20, 20.15s/it]
Traceback (most recent call last):
  File "/cluster/home/largraf/DeepLearning_project/ETHz-DeepLearning-Project/fisher_pruning/main.py", line 179, in <module>
    main()
  File "/cluster/home/largraf/DeepLearning_project/ETHz-DeepLearning-Project/fisher_pruning/main.py", line 168, in main
    losses = test_model(model, head_mask, neuron_mask, test_dataloader, device)
  File "/cluster/home/largraf/miniconda3/envs/clip/lib/python3.9/site-packages/torch/autograd/grad_mode.py", line 27, in decorate_context
    return func(*args, **kwargs)
  File "/cluster/home/largraf/DeepLearning_project/ETHz-DeepLearning-Project/fisher_pruning/evaluate/eval.py", line 32, in test_model
    outputs = model.get_image_features(**batch[0], head_mask=h_masks[i])
  File "/cluster/home/largraf/DeepLearning_project/ETHz-DeepLearning-Project/fisher_pruning/modeling_clip.py", line 985, in get_image_features
    vision_outputs = self.vision_model(
  File "/cluster/home/largraf/miniconda3/envs/clip/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/cluster/home/largraf/DeepLearning_project/ETHz-DeepLearning-Project/fisher_pruning/modeling_clip.py", line 790, in forward
    encoder_outputs = self.encoder(
  File "/cluster/home/largraf/miniconda3/envs/clip/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/cluster/home/largraf/DeepLearning_project/ETHz-DeepLearning-Project/fisher_pruning/modeling_clip.py", line 587, in forward
    layer_outputs = encoder_layer(
  File "/cluster/home/largraf/miniconda3/envs/clip/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/cluster/home/largraf/DeepLearning_project/ETHz-DeepLearning-Project/fisher_pruning/modeling_clip.py", line 325, in forward
    hidden_states, attn_weights = self.self_attn(
  File "/cluster/home/largraf/miniconda3/envs/clip/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/cluster/home/largraf/DeepLearning_project/ETHz-DeepLearning-Project/fisher_pruning/modeling_clip.py", line 260, in forward
    attn_probs_reshaped = attn_probs_reshaped.permute(0,3,2,1) * head_mask
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu!
Traceback (most recent call last):
  File "/cluster/home/largraf/DeepLearning_project/ETHz-DeepLearning-Project/fisher_pruning/main.py", line 5, in <module>
    import numpy as np
ModuleNotFoundError: No module named 'numpy'
12/18/2022 11:51:57 - INFO - __main__ - Namespace(model_name='openai/clip-vit-base-patch32', task_name='mscoco', ckpt_dir='ckpt', output_dir='outputs/openai/clip-vit-base-patch32/mscoco/0.65/seed_14', gpu=1, constraint=0.65, num_samples=2048, seed=14)
12/18/2022 11:51:57 - INFO - __main__ - Seed number: 14
  0%|          | 0/64 [00:00<?, ?it/s]  2%|â–         | 1/64 [00:20<21:07, 20.12s/it]  3%|â–Ž         | 2/64 [00:34<17:27, 16.90s/it]  5%|â–         | 3/64 [00:49<16:21, 16.08s/it]  6%|â–‹         | 4/64 [01:04<15:38, 15.64s/it]  8%|â–Š         | 5/64 [01:19<15:01, 15.29s/it]  9%|â–‰         | 6/64 [01:34<14:37, 15.13s/it] 11%|â–ˆ         | 7/64 [01:49<14:15, 15.02s/it] 12%|â–ˆâ–Ž        | 8/64 [02:03<13:56, 14.94s/it] 14%|â–ˆâ–        | 9/64 [02:18<13:38, 14.88s/it] 16%|â–ˆâ–Œ        | 10/64 [02:33<13:17, 14.77s/it] 17%|â–ˆâ–‹        | 11/64 [02:47<12:57, 14.68s/it] 19%|â–ˆâ–‰        | 12/64 [03:02<12:38, 14.59s/it] 20%|â–ˆâ–ˆ        | 13/64 [03:16<12:29, 14.69s/it] 22%|â–ˆâ–ˆâ–       | 14/64 [03:31<12:11, 14.62s/it] 23%|â–ˆâ–ˆâ–Ž       | 15/64 [03:45<11:52, 14.54s/it] 25%|â–ˆâ–ˆâ–Œ       | 16/64 [04:00<11:40, 14.59s/it] 27%|â–ˆâ–ˆâ–‹       | 17/64 [04:15<11:34, 14.78s/it] 28%|â–ˆâ–ˆâ–Š       | 18/64 [04:30<11:17, 14.74s/it] 30%|â–ˆâ–ˆâ–‰       | 19/64 [04:44<11:00, 14.69s/it] 31%|â–ˆâ–ˆâ–ˆâ–      | 20/64 [04:59<10:48, 14.75s/it] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 21/64 [05:14<10:37, 14.82s/it] 34%|â–ˆâ–ˆâ–ˆâ–      | 22/64 [05:29<10:25, 14.90s/it] 36%|â–ˆâ–ˆâ–ˆâ–Œ      | 23/64 [05:44<10:06, 14.80s/it] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 24/64 [05:58<09:45, 14.65s/it] 39%|â–ˆâ–ˆâ–ˆâ–‰      | 25/64 [06:13<09:35, 14.75s/it] 41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 26/64 [06:28<09:23, 14.82s/it] 42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 27/64 [06:43<09:05, 14.74s/it] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 28/64 [06:57<08:50, 14.72s/it] 45%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 29/64 [07:12<08:36, 14.77s/it] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 30/64 [07:27<08:22, 14.77s/it] 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 31/64 [07:42<08:06, 14.74s/it] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 32/64 [07:57<07:52, 14.77s/it] 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 33/64 [08:11<07:38, 14.77s/it] 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 34/64 [08:26<07:20, 14.70s/it] 55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 35/64 [08:41<07:07, 14.73s/it] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 36/64 [08:55<06:51, 14.70s/it] 58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 37/64 [09:10<06:38, 14.77s/it] 59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 38/64 [09:25<06:23, 14.74s/it] 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 39/64 [09:40<06:08, 14.74s/it] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 40/64 [09:55<05:57, 14.91s/it] 64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 41/64 [10:10<05:42, 14.91s/it] 66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 42/64 [10:24<05:26, 14.82s/it] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 43/64 [10:39<05:09, 14.73s/it] 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 44/64 [10:53<04:53, 14.65s/it] 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 45/64 [11:08<04:38, 14.65s/it] 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 46/64 [11:23<04:25, 14.75s/it] 73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 47/64 [11:38<04:10, 14.74s/it] 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 48/64 [11:52<03:53, 14.60s/it] 77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 49/64 [12:07<03:39, 14.63s/it] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 50/64 [12:22<03:25, 14.69s/it] 80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 51/64 [12:38<03:15, 15.07s/it] 81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 52/64 [12:53<03:02, 15.23s/it] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 53/64 [13:09<02:48, 15.28s/it] 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 54/64 [13:24<02:33, 15.40s/it] 86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 55/64 [13:39<02:18, 15.34s/it] 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 56/64 [13:55<02:02, 15.28s/it] 89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 57/64 [14:09<01:45, 15.08s/it] 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 58/64 [14:24<01:30, 15.03s/it] 92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 59/64 [14:39<01:15, 15.06s/it] 94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 60/64 [14:54<01:00, 15.08s/it] 95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 61/64 [15:09<00:45, 15.08s/it] 97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 62/64 [15:24<00:29, 14.86s/it] 98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 63/64 [15:39<00:14, 14.89s/it]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 64/64 [15:54<00:00, 14.93s/it]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 64/64 [15:54<00:00, 14.91s/it]
12/18/2022 12:08:33 - INFO - __main__ - Pruned Model MAC: 65.00 %
Nonzero headmask and neuron mask percentage:  tensor(0.5694, device='cuda:0') tensor(0.6916, device='cuda:0')
  0%|          | 0/12 [00:00<?, ?it/s]  8%|â–Š         | 1/12 [06:05<1:07:05, 365.93s/it] 17%|â–ˆâ–‹        | 2/12 [07:55<35:49, 214.92s/it]   25%|â–ˆâ–ˆâ–Œ       | 3/12 [11:07<30:42, 204.73s/it] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 4/12 [14:38<27:36, 207.03s/it] 42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 5/12 [17:49<23:29, 201.40s/it] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 6/12 [21:01<19:48, 198.01s/it] 58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 7/12 [24:01<16:01, 192.26s/it] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 8/12 [27:03<12:36, 189.09s/it] 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 9/12 [28:32<07:53, 157.76s/it] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 10/12 [29:17<04:05, 122.76s/it] 92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 11/12 [29:38<01:31, 91.75s/it] 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 12/12 [30:00<00:00, 70.42s/it]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 12/12 [30:00<00:00, 150.02s/it]
12/18/2022 12:38:39 - INFO - __main__ - mscoco Pruning time (s): 2760.804800748825
abnormal scale factor neuron: tensor(-3.9720, dtype=torch.float64) tensor(25.6469, dtype=torch.float64)
abnormal scale factor neuron: tensor(-8.6882, dtype=torch.float64) tensor(25.7067, dtype=torch.float64)
  0%|          | 0/4 [00:00<?, ?it/s] 25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:19<00:58, 19.43s/it] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:38<00:38, 19.24s/it] 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:57<00:19, 19.18s/it]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [01:16<00:00, 19.12s/it]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [01:16<00:00, 19.17s/it]
12/18/2022 12:39:57 - INFO - __main__ - Losses for head mask only: [tensor(8.5681e-07, device='cuda:0'), tensor(0.0007, device='cuda:0'), tensor(3.1366e-06, device='cuda:0'), tensor(0.6297, device='cuda:0'), tensor(2.8471e-05, device='cuda:0'), tensor(0.0580, device='cuda:0'), tensor(7.9674e-05, device='cuda:0'), tensor(0.0254, device='cuda:0')]
12/18/2022 12:39:57 - INFO - __main__ - Losses for neuron mask only: [tensor(0.0005, device='cuda:0'), tensor(0.0753, device='cuda:0'), tensor(0.1431, device='cuda:0'), tensor(0.2623, device='cuda:0'), tensor(0.1749, device='cuda:0'), tensor(0.0212, device='cuda:0'), tensor(0.2117, device='cuda:0'), tensor(0.0759, device='cuda:0')]
12/18/2022 12:39:57 - INFO - __main__ - Losses for both masks: [tensor(0.2563, device='cuda:0'), tensor(0.4284, device='cuda:0'), tensor(0.1362, device='cuda:0'), tensor(0.8751, device='cuda:0'), tensor(0.1541, device='cuda:0'), tensor(0.8832, device='cuda:0'), tensor(0.4569, device='cuda:0'), tensor(0.5652, device='cuda:0')]
12/18/2022 12:39:57 - INFO - __main__ - Losses for random binary masks with same number of zeros: [tensor(2.3938, device='cuda:0'), tensor(3.1246, device='cuda:0'), tensor(3.2447, device='cuda:0'), tensor(5.2044, device='cuda:0'), tensor(7.2538, device='cuda:0'), tensor(3.1872, device='cuda:0'), tensor(5.1027, device='cuda:0'), tensor(3.0824, device='cuda:0')]
12/18/2022 13:03:52 - INFO - __main__ - Namespace(model_name='openai/clip-vit-base-patch32', task_name='mscoco', ckpt_dir='ckpt', output_dir='outputs/openai/clip-vit-base-patch32/mscoco/0.65/seed_651', gpu=1, constraint=0.65, num_samples=2048, seed=651)
12/18/2022 13:03:52 - INFO - __main__ - Seed number: 651
  0%|          | 0/64 [00:00<?, ?it/s]  2%|â–         | 1/64 [00:15<16:25, 15.64s/it]  3%|â–Ž         | 2/64 [00:30<15:36, 15.10s/it]  5%|â–         | 3/64 [00:45<15:14, 15.00s/it]  6%|â–‹         | 4/64 [01:00<14:57, 14.96s/it]  8%|â–Š         | 5/64 [01:14<14:24, 14.65s/it]  9%|â–‰         | 6/64 [01:28<14:05, 14.58s/it] 11%|â–ˆ         | 7/64 [01:43<13:55, 14.65s/it] 12%|â–ˆâ–Ž        | 8/64 [01:58<13:42, 14.69s/it] 14%|â–ˆâ–        | 9/64 [02:12<13:25, 14.64s/it] 16%|â–ˆâ–Œ        | 10/64 [02:27<13:05, 14.55s/it] 17%|â–ˆâ–‹        | 11/64 [02:41<12:51, 14.55s/it] 19%|â–ˆâ–‰        | 12/64 [02:56<12:32, 14.48s/it] 20%|â–ˆâ–ˆ        | 13/64 [03:10<12:15, 14.42s/it] 22%|â–ˆâ–ˆâ–       | 14/64 [03:24<12:02, 14.45s/it] 23%|â–ˆâ–ˆâ–Ž       | 15/64 [03:39<11:53, 14.56s/it] 25%|â–ˆâ–ˆâ–Œ       | 16/64 [03:54<11:39, 14.57s/it] 27%|â–ˆâ–ˆâ–‹       | 17/64 [04:08<11:22, 14.52s/it] 28%|â–ˆâ–ˆâ–Š       | 18/64 [04:23<11:08, 14.53s/it] 30%|â–ˆâ–ˆâ–‰       | 19/64 [04:38<11:03, 14.73s/it] 31%|â–ˆâ–ˆâ–ˆâ–      | 20/64 [04:52<10:45, 14.68s/it] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 21/64 [05:07<10:26, 14.57s/it] 34%|â–ˆâ–ˆâ–ˆâ–      | 22/64 [05:22<10:14, 14.63s/it] 36%|â–ˆâ–ˆâ–ˆâ–Œ      | 23/64 [05:37<10:07, 14.82s/it] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 24/64 [05:51<09:51, 14.78s/it] 39%|â–ˆâ–ˆâ–ˆâ–‰      | 25/64 [06:06<09:33, 14.70s/it] 41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 26/64 [06:21<09:19, 14.73s/it] 42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 27/64 [06:35<09:02, 14.67s/it] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 28/64 [06:50<08:45, 14.60s/it] 45%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 29/64 [07:04<08:30, 14.58s/it] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 30/64 [07:19<08:15, 14.56s/it] 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 31/64 [07:33<08:00, 14.56s/it] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 32/64 [07:48<07:47, 14.60s/it] 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 33/64 [08:03<07:32, 14.58s/it] 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 34/64 [08:17<07:15, 14.53s/it] 55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 35/64 [08:32<07:04, 14.65s/it] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 36/64 [08:47<06:51, 14.68s/it] 58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 37/64 [09:01<06:36, 14.70s/it] 59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 38/64 [09:16<06:21, 14.69s/it] 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 39/64 [09:31<06:09, 14.79s/it] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 40/64 [09:46<05:54, 14.77s/it] 64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 41/64 [10:00<05:37, 14.66s/it] 66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 42/64 [10:15<05:20, 14.55s/it] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 43/64 [10:30<05:11, 14.84s/it] 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 44/64 [10:45<04:56, 14.82s/it] 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 45/64 [11:00<04:40, 14.78s/it] 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 46/64 [11:16<04:37, 15.42s/it] 73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 47/64 [11:32<04:23, 15.52s/it] 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 48/64 [11:47<04:06, 15.42s/it] 77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 49/64 [12:03<03:50, 15.37s/it] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 50/64 [12:18<03:35, 15.38s/it] 80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 51/64 [12:33<03:18, 15.28s/it] 81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 52/64 [12:48<03:02, 15.20s/it] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 53/64 [13:03<02:45, 15.08s/it] 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 54/64 [13:18<02:29, 14.96s/it] 86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 55/64 [13:32<02:14, 14.92s/it] 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 56/64 [13:48<01:59, 14.98s/it] 89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 57/64 [14:02<01:44, 14.90s/it] 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 58/64 [14:17<01:29, 14.91s/it] 92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 59/64 [14:32<01:14, 14.92s/it] 94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 60/64 [14:47<00:59, 14.97s/it] 95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 61/64 [15:02<00:45, 15.02s/it] 97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 62/64 [15:17<00:29, 14.92s/it] 98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 63/64 [15:32<00:15, 15.02s/it]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 64/64 [15:47<00:00, 15.01s/it]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 64/64 [15:47<00:00, 14.81s/it]
12/18/2022 13:20:12 - INFO - __main__ - Pruned Model MAC: 65.00 %
Nonzero headmask and neuron mask percentage:  tensor(0.7569, device='cuda:0') tensor(0.5948, device='cuda:0')
  0%|          | 0/12 [00:00<?, ?it/s]  8%|â–Š         | 1/12 [05:44<1:03:06, 344.26s/it] 17%|â–ˆâ–‹        | 2/12 [07:06<31:40, 190.06s/it]   25%|â–ˆâ–ˆâ–Œ       | 3/12 [09:42<26:12, 174.68s/it] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 4/12 [12:39<23:22, 175.33s/it] 42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 5/12 [15:15<19:40, 168.59s/it] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 6/12 [17:54<16:31, 165.20s/it] 58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 7/12 [20:24<13:21, 160.35s/it] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 8/12 [22:55<10:29, 157.44s/it] 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 9/12 [23:50<06:15, 125.30s/it] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 10/12 [24:14<03:07, 93.86s/it] 92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 11/12 [24:27<01:09, 69.37s/it]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 12/12 [24:39<00:00, 51.91s/it]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 12/12 [24:39<00:00, 123.32s/it]
12/18/2022 13:44:58 - INFO - __main__ - mscoco Pruning time (s): 2434.1034214496613
abnormal scale factor neuron: tensor(-5.8252, dtype=torch.float64) tensor(27.1367, dtype=torch.float64)
abnormal scale factor neuron: tensor(-8.4838, dtype=torch.float64) tensor(19.4341, dtype=torch.float64)
  0%|          | 0/4 [00:00<?, ?it/s] 25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:19<00:59, 19.70s/it] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:38<00:38, 19.22s/it] 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:57<00:19, 19.05s/it]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [01:16<00:00, 19.14s/it]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [01:16<00:00, 19.18s/it]
12/18/2022 13:46:15 - INFO - __main__ - Losses for head mask only: [tensor(0.1733, device='cuda:0'), tensor(0., device='cuda:0'), tensor(0.1733, device='cuda:0'), tensor(0., device='cuda:0'), tensor(0., device='cuda:0'), tensor(2.9802e-08, device='cuda:0'), tensor(9.0151e-07, device='cuda:0'), tensor(0., device='cuda:0')]
12/18/2022 13:46:15 - INFO - __main__ - Losses for neuron mask only: [tensor(0.2140, device='cuda:0'), tensor(0.0013, device='cuda:0'), tensor(0.1777, device='cuda:0'), tensor(0.0125, device='cuda:0'), tensor(0.3604, device='cuda:0'), tensor(0.5972, device='cuda:0'), tensor(0.0087, device='cuda:0'), tensor(0.0043, device='cuda:0')]
12/18/2022 13:46:15 - INFO - __main__ - Losses for both masks: [tensor(0.3012, device='cuda:0'), tensor(0.1871, device='cuda:0'), tensor(0.1739, device='cuda:0'), tensor(0.0078, device='cuda:0'), tensor(0.5086, device='cuda:0'), tensor(0.7925, device='cuda:0'), tensor(0.1884, device='cuda:0'), tensor(0.5353, device='cuda:0')]
12/18/2022 13:46:15 - INFO - __main__ - Losses for random binary masks with same number of zeros: [tensor(4.5475, device='cuda:0'), tensor(4.3829, device='cuda:0'), tensor(3.7953, device='cuda:0'), tensor(3.2892, device='cuda:0'), tensor(3.4441, device='cuda:0'), tensor(4.5986, device='cuda:0'), tensor(5.1125, device='cuda:0'), tensor(1.8113, device='cuda:0')]
12/18/2022 13:58:38 - INFO - __main__ - Namespace(model_name='openai/clip-vit-base-patch32', task_name='mscoco', ckpt_dir='ckpt', output_dir='outputs/openai/clip-vit-base-patch32/mscoco/0.7/seed_4096', gpu=1, constraint=0.7, num_samples=4096, seed=4096)
12/18/2022 13:58:38 - INFO - __main__ - Seed number: 4096
  0%|          | 0/128 [00:00<?, ?it/s]  1%|          | 1/128 [00:16<34:11, 16.15s/it]  2%|â–         | 2/128 [00:30<32:08, 15.30s/it]  2%|â–         | 3/128 [00:45<30:56, 14.85s/it]  3%|â–Ž         | 4/128 [00:59<30:35, 14.80s/it]  4%|â–         | 5/128 [01:14<30:12, 14.74s/it]  5%|â–         | 6/128 [01:28<29:36, 14.56s/it]  5%|â–Œ         | 7/128 [01:43<29:19, 14.54s/it]  6%|â–‹         | 8/128 [01:57<29:09, 14.58s/it]  7%|â–‹         | 9/128 [02:12<29:01, 14.64s/it]  8%|â–Š         | 10/128 [02:27<28:41, 14.59s/it]  9%|â–Š         | 11/128 [02:41<28:17, 14.51s/it]  9%|â–‰         | 12/128 [02:55<28:01, 14.50s/it] 10%|â–ˆ         | 13/128 [03:10<27:59, 14.60s/it] 11%|â–ˆ         | 14/128 [03:24<27:30, 14.48s/it] 12%|â–ˆâ–        | 15/128 [03:39<27:01, 14.35s/it] 12%|â–ˆâ–Ž        | 16/128 [03:53<27:05, 14.52s/it] 13%|â–ˆâ–Ž        | 17/128 [04:08<26:54, 14.54s/it] 14%|â–ˆâ–        | 18/128 [04:22<26:35, 14.51s/it] 15%|â–ˆâ–        | 19/128 [04:37<26:11, 14.42s/it] 16%|â–ˆâ–Œ        | 20/128 [04:51<25:57, 14.42s/it] 16%|â–ˆâ–‹        | 21/128 [05:06<26:08, 14.65s/it] 17%|â–ˆâ–‹        | 22/128 [05:21<26:05, 14.77s/it] 18%|â–ˆâ–Š        | 23/128 [05:36<25:45, 14.72s/it] 19%|â–ˆâ–‰        | 24/128 [05:50<25:25, 14.67s/it] 20%|â–ˆâ–‰        | 25/128 [06:05<25:19, 14.75s/it] 20%|â–ˆâ–ˆ        | 26/128 [06:20<25:05, 14.76s/it] 21%|â–ˆâ–ˆ        | 27/128 [06:35<25:01, 14.86s/it] 22%|â–ˆâ–ˆâ–       | 28/128 [06:51<25:14, 15.14s/it] 23%|â–ˆâ–ˆâ–Ž       | 29/128 [07:07<25:12, 15.28s/it] 23%|â–ˆâ–ˆâ–Ž       | 30/128 [07:22<24:56, 15.27s/it] 24%|â–ˆâ–ˆâ–       | 31/128 [07:38<24:53, 15.40s/it] 25%|â–ˆâ–ˆâ–Œ       | 32/128 [07:53<24:34, 15.36s/it] 26%|â–ˆâ–ˆâ–Œ       | 33/128 [08:08<24:03, 15.19s/it] 27%|â–ˆâ–ˆâ–‹       | 34/128 [08:23<23:43, 15.14s/it] 27%|â–ˆâ–ˆâ–‹       | 35/128 [08:38<23:25, 15.11s/it] 28%|â–ˆâ–ˆâ–Š       | 36/128 [08:53<23:12, 15.13s/it] 29%|â–ˆâ–ˆâ–‰       | 37/128 [09:08<22:52, 15.09s/it] 30%|â–ˆâ–ˆâ–‰       | 38/128 [09:23<22:33, 15.04s/it] 30%|â–ˆâ–ˆâ–ˆ       | 39/128 [09:38<22:13, 14.98s/it] 31%|â–ˆâ–ˆâ–ˆâ–      | 40/128 [09:53<22:12, 15.14s/it] 32%|â–ˆâ–ˆâ–ˆâ–      | 41/128 [10:08<21:43, 14.99s/it] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 42/128 [10:23<21:24, 14.93s/it] 34%|â–ˆâ–ˆâ–ˆâ–Ž      | 43/128 [10:37<21:02, 14.85s/it] 34%|â–ˆâ–ˆâ–ˆâ–      | 44/128 [10:53<20:56, 14.96s/it] 35%|â–ˆâ–ˆâ–ˆâ–Œ      | 45/128 [11:07<20:39, 14.94s/it] 36%|â–ˆâ–ˆâ–ˆâ–Œ      | 46/128 [11:22<20:17, 14.85s/it] 37%|â–ˆâ–ˆâ–ˆâ–‹      | 47/128 [11:37<20:05, 14.89s/it] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 48/128 [11:51<19:39, 14.74s/it] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 49/128 [12:06<19:20, 14.70s/it] 39%|â–ˆâ–ˆâ–ˆâ–‰      | 50/128 [12:21<19:12, 14.77s/it] 40%|â–ˆâ–ˆâ–ˆâ–‰      | 51/128 [12:36<18:52, 14.71s/it] 41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 52/128 [12:50<18:38, 14.72s/it] 41%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 53/128 [13:05<18:17, 14.63s/it] 42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 54/128 [13:19<17:55, 14.53s/it] 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 55/128 [13:33<17:36, 14.47s/it] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 56/128 [13:48<17:28, 14.56s/it] 45%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 57/128 [14:03<17:14, 14.57s/it] 45%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 58/128 [14:17<16:58, 14.55s/it] 46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 59/128 [14:32<16:55, 14.72s/it] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 60/128 [14:47<16:32, 14.59s/it] 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 61/128 [15:01<16:18, 14.61s/it] 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 62/128 [15:16<16:03, 14.60s/it] 49%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 63/128 [15:30<15:46, 14.56s/it] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 64/128 [15:45<15:39, 14.68s/it] 51%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 65/128 [16:00<15:23, 14.65s/it] 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 66/128 [16:15<15:10, 14.68s/it] 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 67/128 [16:30<14:59, 14.75s/it] 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 68/128 [16:44<14:45, 14.76s/it] 54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 69/128 [16:58<14:19, 14.58s/it] 55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 70/128 [17:13<14:09, 14.65s/it] 55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 71/128 [17:28<14:00, 14.74s/it] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 72/128 [17:43<13:49, 14.81s/it] 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 73/128 [17:58<13:31, 14.76s/it] 58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 74/128 [18:12<13:10, 14.63s/it] 59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 75/128 [18:27<12:58, 14.68s/it] 59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 76/128 [18:42<12:48, 14.79s/it] 60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 77/128 [18:57<12:29, 14.70s/it] 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 78/128 [19:11<12:10, 14.61s/it] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 79/128 [19:26<12:00, 14.70s/it] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 80/128 [19:40<11:43, 14.66s/it] 63%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 81/128 [19:55<11:30, 14.70s/it] 64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 82/128 [20:10<11:21, 14.81s/it] 65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 83/128 [20:25<11:11, 14.92s/it] 66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 84/128 [20:40<10:52, 14.83s/it] 66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 85/128 [20:55<10:34, 14.75s/it] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 86/128 [21:09<10:19, 14.76s/it] 68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 87/128 [21:24<10:03, 14.71s/it] 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 88/128 [21:39<09:47, 14.69s/it] 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 89/128 [21:53<09:30, 14.62s/it] 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 90/128 [22:08<09:13, 14.56s/it] 71%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 91/128 [22:22<09:01, 14.64s/it] 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 92/128 [22:37<08:47, 14.65s/it] 73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 93/128 [22:51<08:30, 14.59s/it] 73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 94/128 [23:06<08:20, 14.71s/it] 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 95/128 [23:21<08:07, 14.77s/it] 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 96/128 [23:36<07:47, 14.61s/it]output_dir='outputs/openai/clip-vit-base-patch32/mscoco/0.75/seed_4096', gpu=1, constraint=0.75, num_samples=4096, seed=4096)
12/18/2022 14:22:22 - INFO - __main__ - Seed number: 4096
                                                                   0%|          | 0/128 [00:00<?, ?it/s]  1%|          | 1/128 [00:19<41:05, 19.41s/it]  2%|â–         | 2/128 [00:33<34:21, 16.36s/it]  2%|â–         | 3/128 [00:47<32:06, 15.41s/it]  3%|â–Ž         | 4/128 [01:02<31:33, 15.27s/it]                          4%|â–         | 5/128 [01:17<31:03, 15.15s/it]  5%|â–         | 6/128 [01:32<30:28, 14.99s/it]                                  5%|â–Œ         | 7/128 [01:47<30:18, 15.03s/it]  6%|â–‹         | 8/128 [02:02<29:41, 14.85s/it]                                      7%|â–‹         | 9/128 [02:16<29:01, 14.63s/it]  8%|â–Š         | 10/128 [02:31<28:50, 14.66s/it]  9%|â–Š         | 11/128 [02:45<28:30, 14.62s/it]  9%|â–‰         | 12/128 [03:00<28:15, 14.62s/it] 10%|â–ˆ         | 13/128 [03:14<27:54, 14.56s/it]                   11%|â–ˆ         | 14/128 [03:29<27:44, 14.60s/it] 12%|â–ˆâ–        | 15/128 [03:43<27:30, 14.61s/it]                                                                                                     12%|â–ˆâ–Ž        | 16/128 [03:58<27:07, 14.53s/it] 13%|â–ˆâ–Ž        | 17/128 [04:15<28:15, 15.28s/it]                                                                                                                                                        14%|â–ˆâ–        | 18/128 [04:30<28:09, 15.36s/it] 15%|â–ˆâ–        | 19/128 [04:46<27:51, 15.34s/it] 16%|â–ˆâ–Œ        | 20/128 [05:01<27:42, 15.40s/it]                                                  16%|â–ˆâ–‹        | 21/128 [05:17<27:26, 15.39s/it] 17%|â–ˆâ–‹        | 22/128 [05:32<27:12, 15.40s/it] 18%|â–ˆâ–Š        | 23/128 [05:46<26:26, 15.11s/it]                                                                       19%|â–ˆâ–‰        | 24/128 [06:02<26:15, 15.15s/it] 20%|â–ˆâ–‰        | 25/128 [06:16<25:43, 14.98s/it] 20%|â–ˆâ–ˆ        | 26/128 [06:31<25:17, 14.88s/it]                                                                       21%|â–ˆâ–ˆ        | 27/128 [06:45<24:46, 14.72s/it] 22%|â–ˆâ–ˆâ–       | 28/128 [07:00<24:31, 14.72s/it] 23%|â–ˆâ–ˆâ–Ž       | 29/128 [07:15<24:18, 14.73s/it]                                                                       23%|â–ˆâ–ˆâ–Ž       | 30/128 [07:29<24:00, 14.70s/it] 24%|â–ˆâ–ˆâ–       | 31/128 [07:44<23:43, 14.68s/it] 25%|â–ˆâ–ˆâ–Œ       | 32/128 [07:59<23:32, 14.72s/it]                                                                                                                                                                                                26%|â–ˆâ–ˆâ–Œ       | 33/128 [08:13<23:13, 14.67s/it] 27%|â–ˆâ–ˆâ–‹       | 34/128 [08:29<23:36, 15.07s/it] 27%|â–ˆâ–ˆâ–‹       | 35/128 [08:45<23:42, 15.30s/it] 28%|â–ˆâ–ˆâ–Š       | 36/128 [09:01<23:46, 15.51s/it] 29%|â–ˆâ–ˆâ–‰       | 37/128 [09:16<23:26, 15.45s/it] 30%|â–ˆâ–ˆâ–‰       | 38/128 [09:32<23:15, 15.50s/it] 30%|â–ˆâ–ˆâ–ˆ       | 39/128 [09:47<22:54, 15.44s/it] 31%|â–ˆâ–ˆâ–ˆâ–      | 40/128 [10:03<22:44, 15.50s/it] 32%|â–ˆâ–ˆâ–ˆâ–      | 41/128 [10:18<22:21, 15.42s/it] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 42/128 [10:33<21:52, 15.26s/it] 34%|â–ˆâ–ˆâ–ˆâ–Ž      | 43/128 [10:48<21:31, 15.19s/it] 34%|â–ˆâ–ˆâ–ˆâ–      | 44/128 [11:03<21:18, 15.22s/it] 35%|â–ˆâ–ˆâ–ˆâ–Œ      | 45/128 [11:18<20:46, 15.02s/it] 36%|â–ˆâ–ˆâ–ˆâ–Œ      | 46/128 [11:33<20:39, 15.12s/it] 37%|â–ˆâ–ˆâ–ˆâ–‹      | 47/128 [11:48<20:17, 15.03s/it] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 48/128 [12:03<20:04, 15.06s/it] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 49/128 [12:18<19:37, 14.90s/it] 39%|â–ˆâ–ˆâ–ˆâ–‰      | 50/128 [12:33<19:16, 14.83s/it] 40%|â–ˆâ–ˆâ–ˆâ–‰      | 51/128 [12:47<19:00, 14.81s/it] 41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 52/128 [13:02<18:43, 14.79s/it] 41%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 53/128 [13:17<18:27, 14.77s/it] 42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 54/128 [13:32<18:15, 14.80s/it] 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 55/128 [13:46<17:51, 14.68s/it] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 56/128 [14:01<17:35, 14.66s/it] 45%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 57/128 [14:15<17:15, 14.59s/it] 45%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 58/128 [14:30<17:03, 14.62s/it] 46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 59/128 [14:44<16:44, 14.56s/it] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 60/128 [14:59<16:32, 14.60s/it] 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 61/128 [15:14<16:21, 14.65s/it] 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 62/128 [15:28<16:05, 14.63s/it] 49%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 63/128 [15:42<15:43, 14.51s/it] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 64/128 [15:57<15:32, 14.57s/it] 51%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 65/128 [16:12<15:14, 14.52s/it] 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 66/128 [16:27<15:14, 14.75s/it] 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 67/128 [16:42<15:02, 14.80s/it] 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 68/128 [16:56<14:43, 14.72s/it] 54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 69/128 [17:11<14:33, 14.81s/it] 55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 70/128 [17:27<14:26, 14.93s/it] 55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 71/128 [17:41<13:58, 14.72s/it] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 72/128 [17:56<13:45, 14.75s/it] 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 73/128 [18:10<13:29, 14.72s/it] 58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 74/128 [18:25<13:18, 14.79s/it] 59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 75/128 [18:40<13:05, 14.81s/it] 59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 76/128 [18:54<12:43, 14.69s/it] 60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 77/128 [19:09<12:33, 14.76s/it] 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 78/128 [19:24<12:15, 14.72s/it] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 79/128 [19:38<11:57, 14.65s/it] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 80/128 [19:53<11:43, 14.66s/it] 63%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 81/128 [20:09<11:40, 14.91s/it] 64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 82/128 [20:24<11:25, 14.90s/it] 65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 83/128 [20:38<11:06, 14.80s/it] 66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 84/128 [20:53<10:51, 14.81s/it] 66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 85/128 [21:08<10:39, 14.87s/it] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 86/128 [21:23<10:26, 14.91s/it] 68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 87/128 [21:37<10:05, 14.78s/it] 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 88/128 [21:52<09:52, 14.82s/it] 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 89/128 [22:08<09:42, 14.94s/it] 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 90/128 [22:22<09:23, 14.84s/it] 71%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 91/128 [22:37<09:06, 14.78s/it] 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 92/128 [22:52<08:53, 14.81s/it] 73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 93/128 [23:07<08:41, 14.91s/it] 73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 94/128 [23:22<08:25, 14.87s/it] 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 95/128 [23:36<08:06, 14.74s/it] 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 96/128 [23:51<07:51, 14.74s/it] 76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 97/128 [24:06<07:40, 14.87s/it] 77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 98/128 [24:21<07:26, 14.87s/it] 77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 99/128 [24:36<07:11, 14.89s/it] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 100/128 [24:50<06:55, 14.82s/it] 79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 101/128 [25:05<06:40, 14.84s/it] 80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 102/128 [25:20<06:24, 14.80s/it] 80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 103/128 [25:35<06:08, 14.72s/it] 81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 104/128 [25:49<05:54, 14.79s/it] 82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 105/128 [26:05<05:42, 14.90s/it] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 106/128 [26:20<05:29, 14.97s/it] 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 107/128 [26:35<05:13, 14.94s/it] 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 108/128 [26:49<04:58, 14.91s/it] 85%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 109/128 [27:05<04:45, 15.00s/it] 86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 110/128 [27:20<04:30, 15.04s/it] 87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 111/128 [27:34<04:13, 14.92s/it] 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 112/128 [27:49<03:58, 14.89s/it] 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 113/128 [28:04<03:44, 14.95s/it] 89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 114/128 [28:19<03:29, 14.96s/it] 90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 115/128 [28:34<03:13, 14.86s/it] 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 116/128 [28:49<02:58, 14.89s/it] 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 117/128 [29:04<02:45, 15.01s/it] 92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 118/128 [29:19<02:29, 14.97s/it] 93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 119/128 [29:34<02:13, 14.85s/it] 94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 120/128 [29:49<01:59, 14.92s/it] 95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 121/128 [30:04<01:44, 14.87s/it] 95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 122/128 [30:18<01:29, 14.84s/it] 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 123/128 [30:33<01:13, 14.76s/it] 97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 124/128 [30:48<00:59, 14.86s/it] 98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 125/128 [31:03<00:44, 14.96s/it] 98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 126/128 [31:18<00:29, 14.92s/it] 99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 127/128 [31:33<00:14, 14.82s/it]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 128/128 [31:48<00:00, 14.90s/it]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 128/128 [31:48<00:00, 14.91s/it]
12/18/2022 14:54:51 - INFO - __main__ - Pruned Model MAC: 75.00 %
Nonzero headmask and neuron mask percentage:  tensor(0.8403, device='cuda:0') tensor(0.7034, device='cuda:0')
  0%|          | 0/12 [00:00<?, ?it/s]                                                                                                                                                                    8%|â–Š         | 1/12 [12:01<2:12:16, 721.52s/it] 17%|â–ˆâ–‹        | 2/12 [15:48<1:11:46, 430.66s/it] 25%|â–ˆâ–ˆâ–Œ       | 3/12 [22:58<1:04:31, 430.16s/it]slurmstepd: error: *** JOB 4472583 ON eu-lo-s4-027 CANCELLED AT 2022-12-18T15:22:00 DUE TO TIME LIMIT ***
Traceback (most recent call last):
  File "/cluster/home/largraf/DeepLearning_project/ETHz-DeepLearning-Project/fisher_pruning/main.py", line 5, in <module>
    import numpy as np
ModuleNotFoundError: No module named 'numpy'
usage: main.py [-h] [--model_name MODEL_NAME] [--task_name {mscoco}]
               [--ckpt_dir CKPT_DIR] [--output_dir OUTPUT_DIR] [--gpu GPU]
               [--constraint CONSTRAINT] [--num_samples NUM_SAMPLES]
               [--seed SEED]
main.py: error: unrecognized arguments: --time=5:00:00
usage: main.py [-h] [--model_name MODEL_NAME] [--task_name {mscoco}]
               [--ckpt_dir CKPT_DIR] [--output_dir OUTPUT_DIR] [--gpu GPU]
               [--constraint CONSTRAINT] [--num_samples NUM_SAMPLES]
               [--seed SEED]
main.py: error: unrecognized arguments: --time=5:00:00
12/18/2022 15:52:01 - INFO - __main__ - Namespace(model_name='openai/clip-vit-base-patch32', task_name='mscoco', ckpt_dir='ckpt', output_dir='outputs/openai/clip-vit-base-patch32/mscoco/0.7/seed_4096', gpu=1, constraint=0.7, num_samples=4096, seed=4096)
12/18/2022 15:52:01 - INFO - __main__ - Seed number: 4096  0%|          | 0/128 [00:00<?, ?it/s]  1%|          | 1/128 [00:14<31:43, 14.98s/it]  2%|â–         | 2/128 [00:28<29:24, 14.00s/it]  2%|â–         | 3/128 [00:41<28:47, 13.82s/it]  2%|â–         | 3/128 [00:42<28:57, 13.90s/it]  4%|â–         | 5/128 [01:08<27:51, 13.59s/it]  5%|â–         | 6/128 [01:22<27:30, 13.53s/it]  4%|â–         | 5/128 [01:09<28:26, 13.87s/it]  5%|â–         | 6/128 [01:23<28:08, 13.84s/it]  6%|â–‹         | 8/128 [01:49<27:11, 13.59s/it]  7%|â–‹         | 9/128 [02:02<26:45, 13.49s/it]  6%|â–‹         | 8/128 [01:51<27:31, 13.77s/it]  7%|â–‹         | 9/128 [02:04<27:10, 13.71s/it]]  9%|â–Š         | 11/128 [02:29<26:15, 13.47s/it]  9%|â–‰         | 12/128 [02:43<26:11, 13.55s/it]  9%|â–Š         | 11/128 [02:33<27:18, 14.01s/it]  9%|â–‰         | 12/128 [02:46<26:55, 13.93s/it] 11%|â–ˆ         | 14/128 [03:10<25:40, 13.51s/it] 12%|â–ˆâ–        | 15/128 [03:24<25:35, 13.59s/it] 12%|â–ˆâ–Ž        | 16/128 [03:37<25:22, 13.60s 12%|â–ˆâ–        | 15/128 [03:28<26:14, 13.94s/it]/it] 14%|â–ˆâ–        | 18/128 [04:05<24:57, 13.61s/it] 15%|â–ˆâ–        | 19/128 [04:18<24:45, 13.63s/it] 14%|â–ˆâ–        | 18/128 [04:10<25:27, 13.88s/it] 16%|â–ˆâ–‹        | 21/128 [04:46<24:26, 13.70s/it] 17%|â–ˆâ–‹        | 22/128 [04:59<24:03, 13.62s/it] 16%|â–ˆâ–‹        | 21/128 [04:51<24:37, 13.81s/it] 19%|â–ˆâ–‰        | 24/128 [05:26<23:30, 13.57s/it] 20%|â–ˆâ–‰        | 25/128 [05:40<23:15, 13.55s/it] 19%|â–ˆâ–‰        | 24/128 [05:33<23:53, 13.79s/it] 21%|â–ˆâ–ˆ        | 27/128 [06:07<22:41, 13.48s/it] 22%|â–ˆâ–ˆâ–       | 28/128 [06:20<22:27, 13.48s/i 21%|â–ˆâ–ˆ        | 27/128 [06:13<23:01, 13.68s/it]/it] 23%|â–ˆâ–ˆâ–Ž       | 30/128 [06:47<22:05, 13.52s/it] 24%|â–ˆâ–ˆâ–       | 31/128 [07:00<21:40, 13.40s/it] 23%|â–ˆâ–ˆâ–Ž       | 30/128 [06:54<22:15, 13.63s/it] 26%|â–ˆâ–ˆâ–Œ       | 33/128 [07:28<21:31, 13.60s/it] 27%|â–ˆâ–ˆâ–‹       | 34/128 [07:42<21:19, 13.61s/it] 26%|â–ˆâ–ˆâ–Œ       | 33/128 [07:36<21:45, 13.75s/it] 28%|â–ˆâ–ˆâ–Š       | 36/128 [08:09<20:46, 13.55s/it] 29%|â–ˆâ–ˆâ–‰       | 37/128 [08:22<20:34, 13.57s/it] 30%|â–ˆâ–ˆâ–‰       | 38/128 [08:36<20:25, 13.61s/it] 30%|â–ˆâ–ˆâ–ˆ       | 39/128 [08:50<20:13, 13.64s/it] 31%|â–ˆâ–ˆâ–ˆâ–      | 40/128 [09:03<19:55, 13.59s/it]30%|â–ˆâ–ˆâ–‰       | 38/128 [08:45<20:44, 13.82s/it] 32%|â–ˆâ–ˆâ–ˆâ–      | 41/128 [09:17<19:40, 13.57s/it] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 42/128 [09:30<19:28, 13.59s/it] 34%|â–ˆâ–ˆâ–ˆâ–Ž      | 43/128 [09:44<19:15, 13.59s/it]32%|â–ˆâ–ˆâ–ˆâ–      | 41/128 [09:28<20:18, 14.01s/it] 34%|â–ˆâ–ˆâ–ˆâ–      | 44/128 [09:57<18:58, 13.56s/it] 35%|â–ˆâ–ˆâ–ˆâ–Œ      | 45/128 [10:11<18:40, 13.50s/it] 36%|â–ˆâ–ˆâ–ˆâ–Œ      | 46/128 [10:25<18:35, 13.61s/it] 34%|â–ˆâ–ˆâ–ˆâ–      | 44/128 [10:10<19:42, 14.08s/it] 37%|â–ˆâ–ˆâ–ˆâ–‹      | 47/128 [10:38<18:23, 13.63s/it] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 48/128 [10:52<18:10, 13.63s/it] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 49/128 [11:05<17:51, 13.56s/it] 37%|â–ˆâ–ˆâ–ˆâ–‹      | 47/128 [10:52<19:03, 14.12s/it] 39%|â–ˆâ–ˆâ–ˆâ–‰      | 50/128 [11:19<17:41, 13.61s/it] 40%|â–ˆâ–ˆâ–ˆâ–‰      | 51/128 [11:33<17:30, 13.65s/it] 41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 52/128 [11:46<17:11, 13.57s/it] 39%|â–ˆâ–ˆâ–ˆâ–‰      | 50/128 [11:35<18:16, 14.06s/it] 41%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 53/128 [11:59<16:52, 13.50s/it] 42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 54/128 [12:13<16:37, 13.48s/it] 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 55/128 [12:27<16:30, 13.57s/it] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 56/128 [12:40<16:16, 13.57s/it] 45%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 57/128 [12:54<16:11, 13.68s/it] 45%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 58/128 [13:08<15:58, 13.70s/it] 46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 59/128 [13:22<15:51, 13.79s/it] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 60/128 [13:36<15:35, 13.76s/it] 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 61/128 [13:49<15:17, 13.70s/it] 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 62/128 [14:03<15:02, 13.67s/it] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 60/128 [13:55<15:51, 14.00s/it] 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 61/128 [14:09<15:46, 14.12s/it] 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 62/128 [14:23<15:32, 14.13s/it] 49%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 63/128 [14:37<15:16, 14.10s/it] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 64/128 [14:52<15:10, 14.23s/it] 51%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 65/128 [15:06<14:58, 14.27s/it]8s/it] 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 66/128 [15:20<14:41, 14.22s/it] 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 67/128 [15:34<14:20, 14.11s/it] 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 68/128 [15:48<14:03, 14.06s/it] 54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 69/128 [16:02<13:52, 14.11s/it] 55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 70/128 [16:17<13:46, 14.25s/it] 55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 71/128 [16:31<13:25, 14.14s/it] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 72/128 [16:45<13:12, 14.16s/it] 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 73/128 [16:59<12:59, 14.18s/it] 58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 74/128 [17:14<12:49, 14.25s/it] 59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 75/128 [17:28<12:31, 14.18s/it] 59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 76/128 [17:42<12:20, 14.24s/it] 60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 77/128 [17:57<12:21, 14.53s/it]/it] 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 78/128 [18:12<12:04, 14.49s/it] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 79/128 [18:26<11:50, 14.51s/it] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 80/128 [18:40<11:29, 14.36s/it]t] 63%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 81/128 [18:55<11:13, 14.34s/it] 64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 82/128 [19:09<10:56, 14.27s/it] 65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 83/128 [19:23<10:43, 14.29s/it] 66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 84/128 [19:37<10:24, 14.20s/it] 66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 85/128 [19:51<10:06, 14.10s/it] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 86/128 [20:05<09:53, 14.13s/it] 68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 87/128 [20:19<09:41, 14.19s/it] 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 88/128 [20:34<09:28, 14.20s/it] 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 89/128 [20:48<09:11, 14.14s/it]t] 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 90/128 [21:02<08:56, 14.12s/it] 71%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 91/128 [21:16<08:45, 14.21s/it] 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 92/128 [21:30<08:29, 14.16s/it]/it] 73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 93/128 [21:44<08:15, 14.17s/it] 73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 94/128 [21:58<08:00, 14.14s/it] 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 95/128 [22:13<07:46, 14.15s/it] 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 96/128 [22:27<07:33, 14.16s/it] 76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 97/128 [22:40<07:14, 14.02s/it] 77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 98/128 [22:54<06:57, 13.92s/it]t] 77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 99/128 [23:09<06:47, 14.06s/it] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 100/128 [23:23<06:35, 14.12s/it] 79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 101/128 [23:37<06:19, 14.07s/it]it] 80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 102/128 [23:51<06:05, 14.05s/it] 80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 103/128 [24:05<05:53, 14.14s/it] 81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 104/128 [24:20<05:41, 14.24s/it]/it] 82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 105/128 [24:34<05:26, 14.21s/it] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 106/128 [24:48<05:13, 14.25s/it] 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 107/128 [25:02<04:58, 14.23s/it] 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 108/128 [25:16<04:43, 14.20s/it] 85%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 109/128 [25:31<04:29, 14.21s/it] 86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 110/128 [25:45<04:14, 14.15s/it] 87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 111/128 [25:59<04:01, 14.18s/it] 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 112/128 [26:13<03:48, 14.27s/it] 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 113/128 [26:28<03:35, 14.34s/it] 89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 114/128 [26:42<03:19, 14.28s/it] 90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 115/128 [26:56<03:04, 14.23s/it] 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 116/128 [27:10<02:51, 14.27s/it]9s/it] 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 117/128 [27:25<02:36, 14.22s/it] 92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 118/128 [27:39<02:21, 14.18s/it] 93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 119/128 [27:53<02:07, 14.15s/it] 94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 120/128 [28:07<01:54, 14.25s/it] 95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 121/128 [28:21<01:39, 14.22s/it] 95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 122/128 [28:35<01:24, 14.12s/it] 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 123/128 [28:49<01:10, 14.14s/it] 97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 124/128 [29:04<00:56, 14.20s/it] 98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 125/128 [29:18<00:42, 14.18s/it]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 128/128 [29:07<00:00, 13.66s/it]
12/18/2022 16:21:19 - INFO - __main__ - Pruned Model MAC: 75.00 %
 98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 126/128 [29:32<00:28, 14.20s/it] 99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 127/128 [29:46<00:14, 14.19s/it]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 128/128 [30:00<00:00, 14.08s/it]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 128/128 [30:00<00:00, 14.07s/it]
12/18/2022 16:22:34 - INFO - __main__ - Pruned Model MAC: 70.00 %
Nonzero headmask and neuron mask percentage:  tensor(0.7986, device='cuda:0') tensor(0.6491, device='cuda:0')
  0%|          | 0/12 [00:00<?, ?it/s]  8%|â–Š         | 1/12 [11:12<2:03:14, 672.24s/it]  8%|â–Š         | 1/12 [11:26<2:05:56, 686.99s/it] 17%|â–ˆâ–‹        | 2/12 [14:55<1:08:01, 408.17s/it] 17%|â–ˆâ–‹        | 2/12 [14:41<1:06:10, 397.06s/it] 25%|â–ˆâ–ˆâ–Œ       | 3/12 [21:33<1:00:31, 403.52s/it] 25%|â–ˆâ–ˆâ–Œ       | 3/12 [20:49<57:37, 384.16s/it]   33%|â–ˆâ–ˆâ–ˆâ–Ž      | 4/12 [27:02<50:36, 379.56s/it]   42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 5/12 [34:32<45:57, 393.92s/it] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 6/12 [40:33<38:16, 382.75s/it] 58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 7/12 [46:30<31:11, 374.23s/it] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 8/12 [50:03<23:04, 346.17s/it] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 8/12 [52:29<24:37, 369.38s/it] 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 9/12 [52:19<14:01, 280.45s/it] 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 9/12 [55:14<15:17, 305.68s/it]it] 92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 11/12 [54:09<02:41, 161.14s/it]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 12/12 [54:40<00:00, 121.73s/it]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 12/12 [54:40<00:00, 273.41s/it]
12/18/2022 17:17:23 - INFO - __main__ - mscoco Pruning time (s): 5090.306528568268
abnormal scale factor neuron: tensor(-6.5243, dtype=torch.float64) tensor(17.5519, dtype=torch.float64)
abnormal scale factor neuron: tensor(-6.8125, dtype=torch.float64) tensor(13.2516, dtype=torch.float64)
  0%|          | 0/4 [00:00<?, ?it/s] 25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:18<00:56, 18.77s/it] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 10/12 [56:56<08:05, 242.73s/it]ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:55<00:18, 18.36s/it]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [01:13<00:00, 18.30s/it]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [01:13<00:00, 18.38s/it]
12/18/2022 17:18:37 - INFO - __main__ - Losses for head mask only: [tensor(0., device='cuda:0'), tensor(0.1733, device='cuda:0'), tensor(0.3466, device='cuda:0'), tensor(0., device='cuda:0'), tensor(0., device='cuda:0'), tensor(1.6174e-05, device='cuda:0'), tensor(0., device='cuda:0'), tensor(3.5018e-07, device='cuda:0')]
12/18/2022 17:18:37 - INFO - __main__ - Losses for neuron mask only: [tensor(0.0001, device='cuda:0'), tensor(0.2219, device='cuda:0'), tensor(0.3574, device='cuda:0'), tensor(0.0007, device='cuda:0'), tensor(0.0020, device='cuda:0'), tensor(0.0111, device='cuda:0'), tensor(0.0165, device='cuda:0'), tensor(0.0199, device='cuda:0')]
12/18/2022 17:18:37 - INFO - __main__ - Losses for both masks: [tensor(0.0005, device='cuda:0'), tensor(0.4767, device='cuda:0'), tensor(0.3909, device='cuda:0'), tensor(0.0563, device='cuda:0'), tensor(0.0011, device='cuda:0'), tensor(0.2761, device='cuda:0'), tensor(0.0449, device='cuda:0'), tensor(0.0860, device='cuda:0')]
12/18/2022 17:18:37 - INFO - __main__ - Losses for random binary masks with same number of zeros: [tensor(4.9420, device='cuda:0'), tensor(6.1098, device='cuda:0'), tensor(2.7523, device='cuda:0'), tensor(5.8528, device='cuda:0'), tensor(3.9200, device='cuda:0'), tensor(5.9627, device='cuda:0'), tensor(4.5892, device='cuda:0'), tensor(5.8028, device='cuda:0')]
 92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 11/12 [57:36<03:00, 180.70s/it]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 12/12 [58:17<00:00, 138.17s/it]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 12/12 [58:17<00:00, 291.47s/it]
12/18/2022 17:19:45 - INFO - __main__ - mscoco Pruning time (s): 5253.62754034996
abnormal scale factor neuron: tensor(-4.8167, dtype=torch.float64) tensor(16.0494, dtype=torch.float64)
abnormal scale factor neuron: tensor(-9.0101, dtype=torch.float64) tensor(21.8921, dtype=torch.float64)
  0%|          | 0/4 [00:00<?, ?it/s] 25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:18<00:56, 18.74s/it] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:36<00:36, 18.23s/it] 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:54<00:18, 18.20s/it]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [01:12<00:00, 18.15s/it]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [01:12<00:00, 18.21s/it]
12/18/2022 17:20:58 - INFO - __main__ - Losses for head mask only: [tensor(0., device='cuda:0'), tensor(0., device='cuda:0'), tensor(0., device='cuda:0'), tensor(0., device='cuda:0'), tensor(0., device='cuda:0'), tensor(0., device='cuda:0'), tensor(0.1733, device='cuda:0'), tensor(0., device='cuda:0')]
12/18/2022 17:20:58 - INFO - __main__ - Losses for neuron mask only: [tensor(0.3344, device='cuda:0'), tensor(5.0811e-06, device='cuda:0'), tensor(2.6848e-05, device='cuda:0'), tensor(1.0930e-05, device='cuda:0'), tensor(2.1308e-06, device='cuda:0'), tensor(1.7807e-06, device='cuda:0'), tensor(0.1733, device='cuda:0'), tensor(3.0770e-06, device='cuda:0')]
12/18/2022 17:20:58 - INFO - __main__ - Losses for both masks: [tensor(3.7774e-06, device='cuda:0'), tensor(1.4976e-06, device='cuda:0'), tensor(4.1159e-05, device='cuda:0'), tensor(7.8975e-06, device='cuda:0'), tensor(0.0002, device='cuda:0'), tensor(1.0654e-06, device='cuda:0'), tensor(0.1733, device='cuda:0'), tensor(0.0017, device='cuda:0')]
12/18/2022 17:20:58 - INFO - __main__ - Losses for random binary masks with same number of zeros: [tensor(4.5566, device='cuda:0'), tensor(2.8804, device='cuda:0'), tensor(3.8971, device='cuda:0'), tensor(3.8387, device='cuda:0'), tensor(5.1201, device='cuda:0'), tensor(3.5778, device='cuda:0'), tensor(4.5770, device='cuda:0'), tensor(3.4904, device='cuda:0')]
slurmstepd: error: *** JOB 4530425 ON eu-lo-s4-038 CANCELLED AT 2022-12-19T16:07:24 DUE TO TIME LIMIT ***
slurmstepd: error: *** JOB 4530425 STEPD TERMINATED ON eu-lo-s4-038 AT 2022-12-19T16:10:24 DUE TO JOB NOT ENDING WITH SIGNALS ***
slurmstepd: error: Container 2957 in cgroup plugin has 1 processes, giving up after 191 sec
Traceback (most recent call last):
  File "/cluster/home/largraf/DeepLearning_project/ETHz-DeepLearning-Project/fisher_pruning/main.py", line 5, in <module>
    import numpy as np
ModuleNotFoundError: No module named 'numpy'
12/19/2022 16:54:18 - INFO - __main__ - Namespace(model_name='openai/clip-vit-base-patch32', task_name='mscoco', ckpt_dir='ckpt', output_dir='outputs/openai/clip-vit-base-patch32/mscoco/0.7/seed_111', gpu=1, constraint=0.7, num_samples=4096, seed=111)
12/19/2022 16:54:18 - INFO - __main__ - Seed number: 111
Model loaded
  0%|          | 0/128 [00:00<?, ?it/s]  1%|          | 1/128 [00:14<30:52, 14.58s/it]  2%|â–         | 2/128 [00:26<27:04, 12.89s/it]  2%|â–         | 3/128 [00:37<25:40, 12.33s/it]  3%|â–Ž         | 4/128 [00:49<25:01, 12.11s/it]  4%|â–         | 5/128 [01:01<24:40, 12.04s/it]  5%|â–         | 6/128 [01:13<24:22, 11.99s/it]  5%|â–Œ         | 7/128 [01:25<23:58, 11.89s/it]  6%|â–‹         | 8/128 [01:36<23:40, 11.84s/it]  7%|â–‹         | 9/128 [01:48<23:27, 11.83s/it]  8%|â–Š         | 10/128 [02:00<23:05, 11.74s/it]  9%|â–Š         | 11/128 [02:12<22:55, 11.75s/it]  9%|â–‰         | 12/128 [02:23<22:43, 11.76s/it] 10%|â–ˆ         | 13/128 [02:35<22:28, 11.73s/it] 11%|â–ˆ         | 14/128 [02:47<22:16, 11.72s/it] 12%|â–ˆâ–        | 15/128 [02:58<22:05, 11.73s/it] 12%|â–ˆâ–Ž        | 16/128 [03:10<21:49, 11.70s/it] 13%|â–ˆâ–Ž        | 17/128 [03:22<21:42, 11.73s/it] 14%|â–ˆâ–        | 18/128 [03:33<21:15, 11.60s/it] 15%|â–ˆâ–        | 19/128 [03:45<21:14, 11.70s/it] 16%|â–ˆâ–Œ        | 20/128 [03:57<21:07, 11.73s/it] 16%|â–ˆâ–‹        | 21/128 [04:09<20:54, 11.73s/it] 17%|â–ˆâ–‹        | 22/128 [04:21<21:00, 11.89s/it] 18%|â–ˆâ–Š        | 23/128 [04:33<20:41, 11.82s/it] 19%|â–ˆâ–‰        | 24/128 [04:44<20:30, 11.83s/it] 20%|â–ˆâ–‰        | 25/128 [04:57<20:27, 11.92s/it] 20%|â–ˆâ–ˆ        | 26/128 [05:08<20:03, 11.80s/it] 21%|â–ˆâ–ˆ        | 27/128 [05:20<19:54, 11.82s/it] 22%|â–ˆâ–ˆâ–       | 28/128 [05:32<19:42, 11.82s/it] 23%|â–ˆâ–ˆâ–Ž       | 29/128 [05:44<19:32, 11.84s/it] 23%|â–ˆâ–ˆâ–Ž       | 30/128 [05:55<19:19, 11.83s/it] 24%|â–ˆâ–ˆâ–       | 31/128 [06:07<19:03, 11.79s/it] 25%|â–ˆâ–ˆâ–Œ       | 32/128 [06:19<18:53, 11.81s/it] 26%|â–ˆâ–ˆâ–Œ       | 33/128 [06:31<18:43, 11.83s/it] 27%|â–ˆâ–ˆâ–‹       | 34/128 [06:43<18:28, 11.79s/it] 27%|â–ˆâ–ˆâ–‹       | 35/128 [06:55<18:24, 11.88s/it] 28%|â–ˆâ–ˆâ–Š       | 36/128 [07:07<18:12, 11.88s/it] 29%|â–ˆâ–ˆâ–‰       | 37/128 [07:18<17:55, 11.82s/it] 30%|â–ˆâ–ˆâ–‰       | 38/128 [07:30<17:37, 11.75s/it] 30%|â–ˆâ–ˆâ–ˆ       | 39/128 [07:41<17:17, 11.66s/it] 31%|â–ˆâ–ˆâ–ˆâ–      | 40/128 [07:53<17:07, 11.68s/it] 32%|â–ˆâ–ˆâ–ˆâ–      | 41/128 [08:05<17:03, 11.76s/it] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 42/128 [08:17<16:57, 11.83s/it] 34%|â–ˆâ–ˆâ–ˆâ–Ž      | 43/128 [08:29<16:41, 11.78s/it] 34%|â–ˆâ–ˆâ–ˆâ–      | 44/128 [08:41<16:36, 11.87s/it] 35%|â–ˆâ–ˆâ–ˆâ–Œ      | 45/128 [08:53<16:32, 11.96s/it] 36%|â–ˆâ–ˆâ–ˆâ–Œ      | 46/128 [09:05<16:17, 11.92s/it] 37%|â–ˆâ–ˆâ–ˆâ–‹      | 47/128 [09:16<16:00, 11.85s/it] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 48/128 [09:28<15:51, 11.90s/it] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 49/128 [09:40<15:38, 11.88s/it] 39%|â–ˆâ–ˆâ–ˆâ–‰      | 50/128 [09:52<15:31, 11.94s/it] 40%|â–ˆâ–ˆâ–ˆâ–‰      | 51/128 [10:04<15:15, 11.88s/it] 41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 52/128 [10:16<14:58, 11.82s/it] 41%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 53/128 [10:28<14:52, 11.90s/it] 42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 54/128 [10:40<14:36, 11.84s/it] 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 55/128 [10:51<14:23, 11.83s/it] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 56/128 [11:03<14:13, 11.85s/it] 45%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 57/128 [11:15<13:58, 11.81s/it] 45%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 58/128 [11:26<13:41, 11.73s/it] 46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 59/128 [11:38<13:29, 11.73s/it] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 60/128 [11:50<13:24, 11.83s/it] 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 61/128 [12:02<13:11, 11.81s/it] 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 62/128 [12:14<12:55, 11.76s/it] 49%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 63/128 [12:25<12:39, 11.69s/it] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 64/128 [12:37<12:37, 11.84s/it] 51%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 65/128 [12:49<12:24, 11.82s/it] 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 66/128 [13:01<12:13, 11.82s/it] 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 67/128 [13:13<12:01, 11.82s/it] 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 68/128 [13:25<11:47, 11.80s/it] 54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 69/128 [13:37<11:39, 11.86s/it] 55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 70/128 [13:48<11:23, 11.79s/it] 55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 71/128 [14:00<11:07, 11.71s/it] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 72/128 [14:11<10:54, 11.68s/it] 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 73/128 [14:23<10:45, 11.73s/it] 58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 74/128 [14:35<10:35, 11.77s/it] 59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 75/128 [14:47<10:26, 11.82s/it] 59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 76/128 [14:59<10:10, 11.74s/it] 60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 77/128 [15:10<09:59, 11.76s/it] 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 78/128 [15:22<09:49, 11.78s/it] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 79/128 [15:34<09:34, 11.73s/it] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 80/128 [15:45<09:22, 11.71s/it] 63%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 81/128 [15:57<09:09, 11.68s/it] 64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 82/128 [16:09<09:00, 11.74s/it] 65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 83/128 [16:21<08:47, 11.73s/it] 66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 84/128 [16:33<08:39, 11.80s/it] 66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 85/128 [16:44<08:28, 11.82s/it] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 86/128 [16:56<08:15, 11.80s/it] 68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 87/128 [17:08<08:06, 11.86s/it] 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 88/128 [17:20<07:53, 11.84s/it] 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 89/128 [17:32<07:39, 11.78s/it] 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 90/128 [17:43<07:23, 11.68s/it] 71%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 91/128 [17:55<07:16, 11.79s/it] 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 92/128 [18:07<07:04, 11.79s/it] 73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 93/128 [18:18<06:49, 11.71s/it] 73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 94/128 [18:30<06:38, 11.72s/it] 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 95/128 [18:42<06:28, 11.77s/it] 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 96/128 [18:54<06:14, 11.71s/it] 76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 97/128 [19:06<06:05, 11.80s/it] 77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 98/128 [19:17<05:53, 11.77s/it] 77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 99/128 [19:29<05:40, 11.73s/it] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 100/128 [19:41<05:28, 11.73s/it] 79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 101/128 [19:53<05:19, 11.84s/it] 80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 102/128 [20:04<05:06, 11.78s/it] 80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 103/128 [20:16<04:53, 11.74s/it] 81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 104/128 [20:28<04:42, 11.78s/it] 82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 105/128 [20:40<04:31, 11.82s/it] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 106/128 [20:52<04:19, 11.82s/it] 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 107/128 [21:04<04:08, 11.82s/it] 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 108/128 [21:15<03:56, 11.81s/it] 85%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 109/128 [21:27<03:44, 11.83s/it] 86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 110/128 [21:39<03:32, 11.81s/it] 87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 111/128 [21:51<03:21, 11.83s/it] 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 112/128 [22:03<03:09, 11.85s/it] 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 113/128 [22:15<02:57, 11.85s/it] 89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 114/128 [22:27<02:46, 11.88s/it] 90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 115/128 [22:39<02:35, 11.99s/it] 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 116/128 [22:51<02:22, 11.91s/it] 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 117/128 [23:03<02:11, 11.98s/it] 92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 118/128 [23:15<01:59, 11.96s/it] 93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 119/128 [23:26<01:47, 11.96s/it] 94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 120/128 [23:38<01:35, 11.94s/it] 95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 121/128 [23:50<01:23, 11.94s/it] 95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 122/128 [24:02<01:11, 11.90s/it] 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 123/128 [24:14<00:59, 11.82s/it] 97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 124/128 [24:26<00:47, 11.82s/it] 98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 125/128 [24:37<00:35, 11.84s/it] 98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 126/128 [24:50<00:23, 11.91s/it] 99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 127/128 [25:01<00:11, 11.83s/it]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 128/128 [25:13<00:00, 11.73s/it]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 128/128 [25:13<00:00, 11.82s/it]
12/19/2022 17:19:48 - INFO - __main__ - Pruned Model MAC: 70.00 %
Nonzero headmask and neuron mask percentage:  tensor(0.8125, device='cuda:0') tensor(0.6419, device='cuda:0')
  0%|          | 0/12 [00:00<?, ?it/s]  8%|â–Š         | 1/12 [14:45<2:42:17, 885.20s/it]  8%|â–Š         | 1/12 [14:45<2:42:25, 885.94s/it]
abnormal scale factor neuron: tensor(-4.1790, dtype=torch.float64) tensor(16.0516, dtype=torch.float64)
Traceback (most recent call last):
  File "/cluster/home/largraf/DeepLearning_project/ETHz-DeepLearning-Project/fisher_pruning/main.py", line 180, in <module>
  File "/cluster/home/largraf/DeepLearning_project/ETHz-DeepLearning-Project/fisher_pruning/main.py", line 140, in main
    model,
  File "/cluster/home/largraf/miniconda3/envs/clip/lib/python3.9/site-packages/torch/autograd/grad_mode.py", line 27, in decorate_context
    return func(*args, **kwargs)
  File "/cluster/home/largraf/DeepLearning_project/ETHz-DeepLearning-Project/fisher_pruning/prune/rescale.py", line 198, in rescale_mask
    ATA, ATB = get_mha_lstsq(
  File "/cluster/home/largraf/miniconda3/envs/clip/lib/python3.9/site-packages/torch/autograd/grad_mode.py", line 27, in decorate_context
    return func(*args, **kwargs)
  File "/cluster/home/largraf/DeepLearning_project/ETHz-DeepLearning-Project/fisher_pruning/prune/rescale.py", line 76, in get_mha_lstsq
    A = torch.cat([A, torch.ones(A.shape[0], 1)], dim=1)
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument tensors in method wrapper_cat)
12/19/2022 19:15:55 - INFO - __main__ - Namespace(model_name='openai/clip-vit-base-patch32', task_name='mscoco', ckpt_dir='ckpt', output_dir='outputs/openai/clip-vit-base-patch32/mscoco/0.7/seed_111', gpu=1, constraint=0.7, num_samples=4096, seed=111)
12/19/2022 19:15:55 - INFO - __main__ - Seed number: 111
  0%|          | 0/128 [00:00<?, ?it/s]  1%|          | 1/128 [00:12<25:51, 12.22s/it]  2%|â–         | 2/128 [00:21<22:33, 10.74s/it]  2%|â–         | 3/128 [00:31<21:15, 10.20s/it]  3%|â–Ž         | 4/128 [00:41<20:34,  9.95s/it]  4%|â–         | 5/128 [00:50<20:17,  9.90s/it]  5%|â–         | 6/128 [01:00<19:36,  9.65s/it]  5%|â–Œ         | 7/128 [01:09<19:21,  9.60s/it]  6%|â–‹         | 8/128 [01:18<18:48,  9.40s/it]  7%|â–‹         | 9/128 [01:27<18:41,  9.42s/it]  8%|â–Š         | 10/128 [01:37<18:32,  9.43s/it]  9%|â–Š         | 11/128 [01:46<18:15,  9.36s/it]  9%|â–‰         | 12/128 [01:55<17:57,  9.29s/it] 10%|â–ˆ         | 13/128 [02:04<17:38,  9.20s/it] 11%|â–ˆ         | 14/128 [02:13<17:24,  9.17s/it] 12%|â–ˆâ–        | 15/128 [02:22<17:13,  9.15s/it] 12%|â–ˆâ–Ž        | 16/128 [02:32<17:09,  9.19s/it] 13%|â–ˆâ–Ž        | 17/128 [02:42<17:35,  9.51s/it] 14%|â–ˆâ–        | 18/128 [02:52<17:29,  9.54s/it] 15%|â–ˆâ–        | 19/128 [03:02<17:58,  9.90s/it] 16%|â–ˆâ–Œ        | 20/128 [03:12<17:49,  9.90s/it] 16%|â–ˆâ–‹        | 21/128 [03:22<17:43,  9.94s/it] 17%|â–ˆâ–‹        | 22/128 [03:32<17:26,  9.87s/it] 18%|â–ˆâ–Š        | 23/128 [03:41<16:57,  9.69s/it] 19%|â–ˆâ–‰        | 24/128 [03:51<16:41,  9.63s/it] 20%|â–ˆâ–‰        | 25/128 [04:01<16:37,  9.69s/it] 20%|â–ˆâ–ˆ        | 26/128 [04:10<16:11,  9.52s/it] 21%|â–ˆâ–ˆ        | 27/128 [04:19<15:52,  9.43s/it] 22%|â–ˆâ–ˆâ–       | 28/128 [04:28<15:42,  9.42s/it] 23%|â–ˆâ–ˆâ–Ž       | 29/128 [04:38<15:48,  9.58s/it] 23%|â–ˆâ–ˆâ–Ž       | 30/128 [04:48<15:43,  9.63s/it] 24%|â–ˆâ–ˆâ–       | 31/128 [04:57<15:17,  9.46s/it] 25%|â–ˆâ–ˆâ–Œ       | 32/128 [05:06<15:02,  9.40s/it] 26%|â–ˆâ–ˆâ–Œ       | 33/128 [05:16<14:51,  9.38s/it] 27%|â–ˆâ–ˆâ–‹       | 34/128 [05:25<14:34,  9.31s/it] 27%|â–ˆâ–ˆâ–‹       | 35/128 [05:34<14:20,  9.25s/it] 28%|â–ˆâ–ˆâ–Š       | 36/128 [05:44<14:26,  9.42s/it] 29%|â–ˆâ–ˆâ–‰       | 37/128 [05:53<14:06,  9.30s/it] 30%|â–ˆâ–ˆâ–‰       | 38/128 [06:02<13:47,  9.20s/it] 30%|â–ˆâ–ˆâ–ˆ       | 39/128 [06:11<13:28,  9.08s/it] 31%|â–ˆâ–ˆâ–ˆâ–      | 40/128 [06:19<13:14,  9.03s/it] 32%|â–ˆâ–ˆâ–ˆâ–      | 41/128 [06:28<13:06,  9.04s/it] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 42/128 [06:38<13:01,  9.09s/it] 34%|â–ˆâ–ˆâ–ˆâ–Ž      | 43/128 [06:47<13:02,  9.21s/it] 34%|â–ˆâ–ˆâ–ˆâ–      | 44/128 [06:57<12:56,  9.25s/it] 35%|â–ˆâ–ˆâ–ˆâ–Œ      | 45/128 [07:06<12:50,  9.29s/it] 36%|â–ˆâ–ˆâ–ˆâ–Œ      | 46/128 [07:15<12:35,  9.21s/it] 37%|â–ˆâ–ˆâ–ˆâ–‹      | 47/128 [07:24<12:21,  9.15s/it] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 48/128 [07:33<12:11,  9.15s/it] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 49/128 [07:42<12:08,  9.22s/it] 39%|â–ˆâ–ˆâ–ˆâ–‰      | 50/128 [07:52<12:15,  9.43s/it] 40%|â–ˆâ–ˆâ–ˆâ–‰      | 51/128 [08:02<12:08,  9.46s/it] 41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 52/128 [08:12<12:05,  9.55s/it] 41%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 53/128 [08:21<11:58,  9.57s/it] 42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 54/128 [08:31<11:48,  9.58s/it] 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 55/128 [08:41<11:40,  9.60s/it] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 56/128 [08:50<11:38,  9.70s/it] 45%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 57/128 [09:00<11:24,  9.64s/it] 45%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 58/128 [09:09<11:11,  9.59s/it] 46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 59/128 [09:19<11:01,  9.58s/it] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 60/128 [09:29<10:50,  9.57s/it] 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 61/128 [09:38<10:36,  9.50s/it] 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 62/128 [09:47<10:24,  9.47s/it] 49%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 63/128 [09:57<10:13,  9.44s/it] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 64/128 [10:06<10:07,  9.49s/it] 51%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 65/128 [10:16<09:52,  9.41s/it] 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 66/128 [10:25<09:41,  9.38s/it] 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 67/128 [10:34<09:30,  9.34s/it] 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 68/128 [10:43<09:17,  9.29s/it] 54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 69/128 [10:53<09:08,  9.29s/it] 55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 70/128 [11:02<08:53,  9.20s/it] 55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 71/128 [11:10<08:39,  9.12s/it] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 72/128 [11:19<08:25,  9.02s/it] 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 73/128 [11:29<08:21,  9.12s/it] 58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 74/128 [11:38<08:09,  9.07s/it] 59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 75/128 [11:47<08:00,  9.06s/it] 59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 76/128 [11:55<07:47,  8.98s/it] 60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 77/128 [12:04<07:38,  8.99s/it] 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 78/128 [12:13<07:30,  9.00s/it] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 79/128 [12:22<07:18,  8.95s/it] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 80/128 [12:31<07:07,  8.91s/it] 63%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 81/128 [12:40<06:57,  8.88s/it] 64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 82/128 [12:49<06:49,  8.91s/it] 65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 83/128 [12:58<06:42,  8.94s/it] 66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 84/128 [13:07<06:36,  9.00s/it] 66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 85/128 [13:16<06:26,  8.99s/it] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 86/128 [13:25<06:16,  8.96s/it] 68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 87/128 [13:34<06:08,  8.99s/it] 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 88/128 [13:43<05:59,  8.98s/it] 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 89/128 [13:52<05:48,  8.93s/it] 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 90/128 [14:00<05:37,  8.87s/it] 71%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 91/128 [14:10<05:31,  8.95s/it] 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 92/128 [14:19<05:22,  8.97s/it] 73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 93/128 [14:28<05:15,  9.02s/it] 73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 94/128 [14:37<05:06,  9.02s/it] 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 95/128 [14:46<04:58,  9.04s/it] 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 96/128 [14:55<04:48,  9.01s/it] 76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 97/128 [15:05<04:50,  9.38s/it] 77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 98/128 [15:14<04:42,  9.41s/it] 77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 99/128 [15:23<04:28,  9.27s/it] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 100/128 [15:32<04:16,  9.15s/it] 79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 101/128 [15:41<04:06,  9.13s/it] 80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 102/128 [15:50<03:56,  9.09s/it] 80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 103/128 [15:59<03:45,  9.02s/it] 81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 104/128 [16:08<03:35,  8.98s/it] 82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 105/128 [16:17<03:25,  8.95s/it] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 106/128 [16:26<03:15,  8.90s/it] 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 107/128 [16:35<03:06,  8.90s/it] 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 108/128 [16:44<02:57,  8.87s/it] 85%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 109/128 [16:52<02:48,  8.88s/it] 86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 110/128 [17:01<02:39,  8.86s/it] 87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 111/128 [17:10<02:30,  8.88s/it] 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 112/128 [17:19<02:22,  8.91s/it] 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 113/128 [17:28<02:13,  8.89s/it] 89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 114/128 [17:37<02:04,  8.87s/it] 90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 115/128 [17:46<01:55,  8.89s/it] 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 116/128 [17:55<01:46,  8.86s/it] 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 117/128 [18:04<01:40,  9.11s/it] 92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 118/128 [18:14<01:32,  9.22s/it] 93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 119/128 [18:23<01:22,  9.16s/it] 94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 120/128 [18:32<01:12,  9.08s/it] 95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 121/128 [18:41<01:03,  9.04s/it] 95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 122/128 [18:50<00:54,  9.03s/it] 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 123/128 [18:58<00:44,  8.96s/it] 97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 124/128 [19:07<00:35,  8.94s/it] 98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 125/128 [19:16<00:26,  8.93s/it] 98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 126/128 [19:26<00:18,  9.24s/it] 99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 127/128 [19:36<00:09,  9.34s/it]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 128/128 [19:45<00:00,  9.43s/it]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 128/128 [19:45<00:00,  9.26s/it]
12/19/2022 19:35:54 - INFO - __main__ - Pruned Model MAC: 70.00 %
Nonzero headmask and neuron mask percentage:  tensor(0.8125, device='cuda:0') tensor(0.6419, device='cuda:0')
  0%|          | 0/12 [00:00<?, ?it/s]  8%|â–Š         | 1/12 [11:06<2:02:11, 666.46s/it] 17%|â–ˆâ–‹        | 2/12 [13:09<57:50, 347.02s/it]   25%|â–ˆâ–ˆâ–Œ       | 3/12 [17:14<45:01, 300.15s/it] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 4/12 [21:18<37:03, 277.97s/it] 42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 5/12 [25:20<30:55, 265.01s/it] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 6/12 [29:05<25:09, 251.54s/it] 58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 7/12 [32:28<19:38, 235.63s/it] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 8/12 [35:51<15:01, 225.25s/it] 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 9/12 [37:17<09:04, 181.55s/it] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 10/12 [37:57<04:35, 137.89s/it] 92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 11/12 [38:18<01:42, 102.26s/it]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 12/12 [38:39<00:00, 77.50s/it] 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 12/12 [38:39<00:00, 193.29s/it]
12/19/2022 20:14:37 - INFO - __main__ - mscoco Pruning time (s): 3508.273253917694
abnormal scale factor neuron: tensor(-4.1790, dtype=torch.float64) tensor(16.0516, dtype=torch.float64)
abnormal scale factor neuron: tensor(-9.6113, dtype=torch.float64) tensor(18.6056, dtype=torch.float64)
  0%|          | 0/4 [00:00<?, ?it/s]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|â–ˆâ–Ž        | 1/8 [00:03<00:23,  3.30s/it][A
 25%|â–ˆâ–ˆâ–Œ       | 2/8 [00:06<00:19,  3.25s/it][A
 38%|â–ˆâ–ˆâ–ˆâ–Š      | 3/8 [00:09<00:16,  3.23s/it][A
 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 4/8 [00:12<00:12,  3.22s/it][A
 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 5/8 [00:16<00:09,  3.22s/it][A
 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 6/8 [00:19<00:06,  3.22s/it][A
 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 7/8 [00:22<00:03,  3.21s/it][A
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 8/8 [00:25<00:00,  3.22s/it][A100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 8/8 [00:25<00:00,  3.23s/it]
 25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:25<01:17, 25.80s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|â–ˆâ–Ž        | 1/8 [00:03<00:22,  3.20s/it][A
 25%|â–ˆâ–ˆâ–Œ       | 2/8 [00:06<00:19,  3.21s/it][A
 38%|â–ˆâ–ˆâ–ˆâ–Š      | 3/8 [00:09<00:16,  3.21s/it][A
 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 4/8 [00:12<00:12,  3.21s/it][A
 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 5/8 [00:16<00:09,  3.21s/it][A
 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 6/8 [00:19<00:06,  3.20s/it][A
 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 7/8 [00:22<00:03,  3.20s/it][A
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 8/8 [00:25<00:00,  3.20s/it][A100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 8/8 [00:25<00:00,  3.21s/it]
 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:51<00:51, 25.71s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|â–ˆâ–Ž        | 1/8 [00:03<00:22,  3.21s/it][A
 25%|â–ˆâ–ˆâ–Œ       | 2/8 [00:06<00:19,  3.21s/it][A
 38%|â–ˆâ–ˆâ–ˆâ–Š      | 3/8 [00:09<00:16,  3.21s/it][A
 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 4/8 [00:12<00:12,  3.20s/it][A
 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 5/8 [00:16<00:09,  3.20s/it][A
 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 6/8 [00:19<00:06,  3.21s/it][A
 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 7/8 [00:22<00:03,  3.21s/it][A
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 8/8 [00:25<00:00,  3.21s/it][A100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 8/8 [00:25<00:00,  3.21s/it]
 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [01:17<00:25, 25.68s/it]
  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|â–ˆâ–Ž        | 1/8 [00:03<00:22,  3.24s/it][A
 25%|â–ˆâ–ˆâ–Œ       | 2/8 [00:06<00:19,  3.21s/it][A
 38%|â–ˆâ–ˆâ–ˆâ–Š      | 3/8 [00:09<00:16,  3.21s/it][A
 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 4/8 [00:12<00:12,  3.21s/it][A
 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 5/8 [00:16<00:09,  3.20s/it][A
 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 6/8 [00:19<00:06,  3.20s/it][A
 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 7/8 [00:22<00:03,  3.20s/it][A
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 8/8 [00:25<00:00,  3.20s/it][A100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 8/8 [00:25<00:00,  3.20s/it]
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [01:42<00:00, 25.66s/it]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [01:42<00:00, 25.68s/it]
12/19/2022 20:16:20 - INFO - __main__ - Losses for head mask only: [tensor(2.0638e-06, device='cuda:0'), tensor(0., device='cuda:0'), tensor(0.1733, device='cuda:0'), tensor(0., device='cuda:0'), tensor(1.4901e-08, device='cuda:0'), tensor(0., device='cuda:0'), tensor(0., device='cuda:0'), tensor(3.9488e-07, device='cuda:0')]
12/19/2022 20:16:20 - INFO - __main__ - Losses for neuron mask only: [tensor(0.0251, device='cuda:0'), tensor(7.6814e-06, device='cuda:0'), tensor(0.1733, device='cuda:0'), tensor(0.0003, device='cuda:0'), tensor(0.2260, device='cuda:0'), tensor(0.0196, device='cuda:0'), tensor(1.2211e-05, device='cuda:0'), tensor(0.0641, device='cuda:0')]
12/19/2022 20:16:20 - INFO - __main__ - Losses for both masks: [tensor(0.0007, device='cuda:0'), tensor(0.0003, device='cuda:0'), tensor(0.1734, device='cuda:0'), tensor(0.0002, device='cuda:0'), tensor(0.2511, device='cuda:0'), tensor(0.0878, device='cuda:0'), tensor(0.0003, device='cuda:0'), tensor(0.1887, device='cuda:0')]
12/19/2022 20:16:20 - INFO - __main__ - Losses for random binary masks with same number of zeros: [tensor(3.9512, device='cuda:0'), tensor(4.4653, device='cuda:0'), tensor(5.1640, device='cuda:0'), tensor(3.9376, device='cuda:0'), tensor(3.9543, device='cuda:0'), tensor(4.7746, device='cuda:0'), tensor(3.0442, device='cuda:0'), tensor(6.2594, device='cuda:0')]
